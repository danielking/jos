/*! jedios 2013-10-06 */
(function(){angular.module("common",[]),angular.module("core",["common"]),angular.module("core").run(["apps","$rootScope","common.message",function(a,b,c){return b.$$page_title="jOS",a.load(),c.subscribe("app")}]),window.initUi=function(a){return a=$(a),a.find(".ui.dropdown").dropdown({debug:!1})},$(function(){return angular.bootstrap(document,["core"]),initUi(document)}),angular.module("core").directive("coreApp",["common.message","$http",function(a,b){return{link:function(c,d){return c.$watch("app.actived",function(e,f){return e&&!f&&a.publish("app",{app_name:c.app.name,event:"actived"}),e&&!c.app.loaded?b.get(""+c.app.name+"/index.html").success(function(b){var e;return e=$("<div/>").appendTo(d),e.html(b),angular.bootstrap(e,[c.app.name]),c.app.loaded=!0,a.publish("app",{app_name:c.app.name,event:"loaded"}),d.addClass("app"),initUi(d)}).error(function(){}):void 0})}}}]),angular.module("core").directive("coreNavbar",["$templateCache",function(a){return{template:a.get("navbar.html"),replace:!0,link:function(){}}}]),angular.module("core").service("apps",["$http","$rootScope",function($http,$rootScope){var loadCss,loadJs;return loadJs=function(js){return eval(js)},loadCss=function(a){var b;return b=document.createElement("style"),b.innerHTML=a,document.head.appendChild(b)},$(document).on("app_reg",function(a,b){return $rootScope.$$apps=$rootScope.$$apps||[],$rootScope.$$apps.push(b)}),{load:function(){return $http.get("settings.json").success(function(a){return $rootScope.$$settings=a,async.eachSeries(a.apps,function(a,b){return async.waterfall([function(b){return $http.get(""+a+"/js/main.js").success(function(a){return loadJs(a),b(null)})},function(b){return $http.get(""+a+"/js/templates.js").success(function(a){return loadJs(a),b(null)})},function(b){return $http.get(""+a+"/css/main.css").success(function(a){return loadCss(a),b(null)})},function(b){return $rootScope.$broadcast("app_loaded",a),b(null)}],function(){return b()})},function(){return $rootScope.$broadcast("app_loaded_all")})})},active:function(a){var b,c,d,e,f;for(e=$rootScope.$$apps,f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push(b.actived=b===a);return f}}}]),angular.module("common").service("common.github",["$rootScope",function(){return{auth:function(){}}}]),angular.module("common").service("common.message",["$rootScope",function(a){return{publish:function(a,b){return PubSub.publish(a,b)},subscribe:function(b){return PubSub.subscribe(b,function(b,c){return a.$emit("message",b,c)})}}}]),angular.module("core").controller("CoreController",["$scope","$rootElement","apps","common.message","common.github",function(a,b,c){return b.attr("id","core"),a.desktopActive=!0,a.$on("app_loaded_all",function(){return a.show=!0,a.$digest()}),a.activeApp=function(b){return a.desktopActive=!1,c.active(b)},a.toggleDesktop=function(){return a.desktopActive=!a.desktopActive},a.$on("msg",function(){})}]),angular.module("core").controller("DesktopController",["$scope",function(){}])}).call(this);